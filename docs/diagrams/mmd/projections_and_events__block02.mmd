sequenceDiagram
  participant UI as Settings UI
  participant UR as User Registry
  participant PR as Projection Registry
  participant CB as Capability Broker
  participant VM as VM Subsystem

  UI->>UR: Load Profile
  UR-->>UI: Profile (encrypted-at-rest)
  UI->>PR: Generate projection(scope="research")
  PR->>PR: Apply rules + transforms
  PR-->>UI: Projection {capabilities...}
  UI->>CB: Request capability(gpu_acceleration)
  CB->>PR: Verify projection
  PR-->>CB: allowed: true/false
  alt allowed
    CB->>VM: enable_gpu()
    VM-->>CB: ok
    CB-->>UI: GRANTED
  else denied
    CB-->>UI: DENIED(reason)
  end
